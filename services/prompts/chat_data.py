from services.context import get_context
from services.get_currency import get_currency_rate

async def get_chat_data(user_id: int):
    context = await get_context(user_id)
    if not context:
        return None
    currency_rate = get_currency_rate()
    prompt = f"""  
    –¢–∏ ‚Äî –∞–Ω–∞–ª—ñ—Ç–∏–∫ –¥—ñ–∞–ª–æ–≥—ñ–≤. –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π —Ä–æ–∑–º–æ–≤—É —Ç–∞ –≤–∏—Ç—è–≥–Ω–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è –ü–û–ö–£–ü–ö–ò –∫–≤–∞—Ä—Ç–∏—Ä–∏.

‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û: –¶—ñ–Ω–∏ –û–ë–û–í'–Ø–ó–ö–û–í–û –í –î–û–õ–ê–†–ê–•! API –ø—Ä–∞—Ü—é—î –∑ –ø–æ–∫—É–ø–∫–æ—é –∫–≤–∞—Ä—Ç–∏—Ä, —Ü—ñ–Ω–∏ –≤ USD.

–¢–í–û–Ñ –ó–ê–í–î–ê–ù–ù–Ø:
–í–∏—Ç—è–≥–Ω–∏ –∑ –¥—ñ–∞–ª–æ–≥—É –≤—Å—ñ –∑–≥–∞–¥–∞–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç–∞ –ø–æ–≤–µ—Ä–Ω–∏ —ó—Ö —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON.
–ü–ê–†–ê–ú–ï–¢–†–ò:
1. district_id (–º–∞—Å–∏–≤ —á–∏—Å–µ–ª) - ID —Ä–∞–π–æ–Ω—ñ–≤: 5=–ö–∏—ó–≤—Å—å–∫–∏–π, 6=–ú–∞–ª–∏–Ω–æ–≤—Å—å–∫–∏–π, 8=–ü—Ä–∏–º–æ—Ä—Å—å–∫–∏–π(–¶–µ–Ω—Ç—Ä), 11=–°—É–≤–æ—Ä–æ–≤—Å—å–∫–∏–π
2. microarea_id (–º–∞—Å–∏–≤ —á–∏—Å–µ–ª) - ID –º—ñ–∫—Ä–æ—Ä–∞–π–æ–Ω—ñ–≤
3. rooms_in (–º–∞—Å–∏–≤ —á–∏—Å–µ–ª) - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∫—ñ–º–Ω–∞—Ç: [1], [2], [3], [4] –∞–±–æ [1,2]
4. price_min (—á–∏—Å–ª–æ) - –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ —Ü—ñ–Ω–∞ –í –î–û–õ–ê–†–ê–• (USD)
5. price_max (—á–∏—Å–ª–æ) - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ —Ü—ñ–Ω–∞ –í –î–û–õ–ê–†–ê–• (USD)
6. area_min (—á–∏—Å–ª–æ) - –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –ø–ª–æ—â–∞ –≤ –º¬≤
7. area_max (—á–∏—Å–ª–æ) - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –ø–ª–æ—â–∞ –≤ –º¬≤
8. floor_min (—á–∏—Å–ª–æ) - –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –ø–æ–≤–µ—Ä—Ö
9. floor_max (—á–∏—Å–ª–æ) - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π –ø–æ–≤–µ—Ä—Ö
10. condition_in (–º–∞—Å–∏–≤ —á–∏—Å–µ–ª) - —Å—Ç–∞–Ω –∂–∏—Ç–ª–∞: 6=–ø—ñ–¥ –≤—ñ–¥–¥—ñ–ª–∫—É, 7=–∂–∏—Ç–ª–æ–≤–∞, 8=—î–≤—Ä–æ—Ä–µ–º–æ–Ω—Ç, 9=–≤—ñ–¥ –±—É–¥—ñ–≤–µ–ª—å–Ω–∏–∫—ñ–≤

id –º—ñ–∫—Ä–æ—Ä–∞–π–æ–Ω—ñ–≤:  
89: –ë—É–≥–∞–µ–≤–∫–∞  
90: –î–∑–µ—Ä–∂–∏–Ω—Å–∫–æ–≥–æ –ø–æ—Å  
91: –ó–∞—Å—Ç–∞–≤–∞  
92: –õ–µ–Ω–ø–æ—Å–µ–ª–æ–∫  
93: –ú–µ–ª—å–Ω–∏—Ü—ã  
94: –ú–æ–ª–¥–∞–≤–∞–Ω–∫–∞  
95: –°–∞—Ö–∞—Ä–Ω—ã–π –ø–æ—Å  
96: –°–ª–æ–±–æ–¥–∫–∞  
97: –§–æ–Ω—Ç–∞–Ω  
98: –ß–µ—Ä–µ–º—É—à–∫–∏  
99: –ê—Ä–∫–∞–¥–∏—è  
102: –¶–µ–Ω—Ç—Ä  
103: –®–µ–≤—á–µ–Ω–∫–æ-–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π  
104: –ë–æ–ª—å—à–µ–≤–∏–∫  
105: –ö–æ—Ç–æ–≤—Å–∫–æ–≥–æ –ø–æ—Å  
106: –ö—Ä–∏–≤–∞—è –ë–∞–ª–∫–∞  
107: –ö—É—è–ª—å–Ω–∏–∫  
108: –õ—É–∑–∞–Ω–æ–≤–∫–∞  
109: –ù–µ—Ñ—Ç—è–Ω–∏–∫–æ–≤ –ø–æ—Å  
110: –ü–µ—Ä–µ—Å—ã–ø—å  
112: –®–µ–≤—á–µ–Ω–∫–æ  
113: –í—É–∑–æ–≤—Å–∫–∏–π  
114: –î–∞—á–∞ –ö–æ–≤–∞–ª–µ–≤—Å–∫–æ–≥–æ  
115: –î—Ä—É–∂–Ω—ã–π –∂/–º  
116: –¢–∞–∏—Ä–æ–≤–∞  
118: –¶–∞—Ä—Å–∫–æ–µ —Å–µ–ª–æ  
119: –ß–µ—Ä–≤–æ–Ω—ã–π —Ö—É—Ç–æ—Ä  
121: –ß–µ—Ä–Ω–æ–º–æ—Ä–∫–∞  
122: –ß—É–±–∞–µ–≤–∫–∞

–ü–†–ê–í–ò–õ–ê:
- –Ø–∫—â–æ –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ –∑–≥–∞–¥—É–≤–∞–≤—Å—è - –ù–ï –≤–∫–ª—é—á–∞–π –π–æ–≥–æ –≤ JSON
- –Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —Å–∫–∞–∑–∞–≤ "–±–µ–∑ —Ä—ñ–∑–Ω–∏—Ü—ñ", "–Ω–µ –≤–∞–∂–ª–∏–≤–æ" - –ù–ï –≤–∫–ª—é—á–∞–π —Ü–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä
- –Ø–∫—â–æ —Å–∫–∞–∑–∞–≤ "–≤—ñ–¥ X –¥–æ Y" - –≤–∫–∞–∂–∏ min —Ç–∞ max
- –Ø–∫—â–æ —Å–∫–∞–∑–∞–≤ "–¥–æ X" - –≤–∫–∞–∂–∏ —Ç—ñ–ª—å–∫–∏ max
- –Ø–∫—â–æ —Å–∫–∞–∑–∞–≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ —á–∏—Å–ª–æ –ø–ª–æ—â—ñ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥ "40 –º¬≤") - –∑—Ä–æ–±–∏ –¥—ñ–∞–ø–∞–∑–æ–Ω ¬±10 (area_min=30, area_max=50)

üíµ –¶–Ü–ù–ò –í –î–û–õ–ê–†–ê–•:
- –ö—É—Ä—Å: {currency_rate['rate']}
- –Ø–∫—â–æ –≤ –¥—ñ–∞–ª–æ–∑—ñ —Ü—ñ–Ω–∞ –≤–∫–∞–∑–∞–Ω–∞ –≤ –≥—Ä–∏–≤–Ω—è—Ö - –û–ë–û–í'–Ø–ó–ö–û–í–û –ø–µ—Ä–µ–≤–µ–¥–∏ –≤ –¥–æ–ª–∞—Ä–∏

–ü–†–ò–ö–õ–ê–î –í–Ü–î–ü–û–í–Ü–î–Ü:
{{
  "rooms_in": [1],
  "price_min": 20000,
  "price_max": 50000,
  "area_min": 30,
  "area_max": 50,
  "floor_min": 1,
  "floor_max": 10,
  "condition_in": [6],
  "district_ids": [5,6,8,11],
  "microarea_ids": [102]
}}

–Ø–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –≤–∫–∞–∑–∞–≤ —è–∫–∏–π—Å—å –ø–∞—Ä–∞–º–µ—Ç—Ä - –ù–ï –≤–∫–ª—é—á–∞–π –π–æ–≥–æ –≤ JSON.
–ü—Ä–∏–∫–ª–∞–¥ –∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
{{
  "rooms_in": [1],
  "price_max": 50000,
  "area_min": 30,
  "area_max": 50,
  "condition_in": [6],
  "district_ids": [5,6,8,11],
  "microarea_ids": [102]
}}
  

–¥—ñ–∞–ª–æ–≥:
{context}

–¢–ï–ü–ï–† –ü–†–û–ê–ù–ê–õ–Ü–ó–£–ô –î–Ü–ê–õ–û–ì –Ü –ü–û–í–ï–†–ù–ò –¢–Ü–õ–¨–ö–ò JSON (–ë–ï–ó –î–û–î–ê–¢–ö–û–í–û–ì–û –¢–ï–ö–°–¢–£):
    """
    return prompt
